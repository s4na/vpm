* プログラム以外は日本語で書いて。
* gitでpushしたら、prタイトルとpr説明も更新して。
* mainブランチからブランチを切るときは、fetchした上で最新のmainブランチからブランチを切って。
* CLAUDE.local.md, CLAUDE.project.md というファイルが存在していたら、それぞれ全行読んでください。

---

## コミットメッセージのフォーマット

`<type>: <subject>` (50文字以内の要約)

```
## User Request
<ユーザーの要望の要約>

## AI Reasoning
<AIの判断・思考プロセス>
- 選択した手法とその理由
- 却下した代替案（あれば）
- 安全性やパフォーマンスへの考慮
```

### 例1: 機能追加

```
feat: ユーザー認証にJWT導入とリフレッシュトークン実装

## User Request
セキュアなログイン機能を実装したい。ステートレスな構成がいい。

## AI Reasoning
- 拡張性を考慮し、SessionではなくJWT（RS256署名）を採用。
- セキュリティ向上のため、アクセストークンは短寿命にし、リフレッシュトークンフローを追加。
- データベースにはハッシュ化したトークンのみを保存するよう設計。
```

### 例2: バグ修正

```
fix: Slug生成時の連続ハイフン問題を修正

## User Request
URLに連続したハイフンが含まれる記事がある。

## AI Reasoning
- 日本語混じりのタイトルで連続ハイフンが発生していた。
- replace(/-+/g, '-') で連続するハイフンを1つに置換するロジックを追加。
- 既存データへの影響は軽微と判断し、マイグレーション不要とした。
```

### 例3: ドキュメント更新

```
docs: PRレビューフィードバックを反映

## User Request
PRレビューの指摘事項を対応してほしい。

## AI Reasoning
- セキュリティ関連（CSRF/XSS対策）の具体例を追加。
- JST変換ガイドを新設し、タイムゾーン関連のミスを防止。
- コミットメッセージの例を追加し、一貫性を向上。
```

---

## PRの作成・更新ルール

PRを作成または更新する際は、以下のフォーマットに従ってください。
コードの変更だけでなく、PRのタイトルと説明文（Description）も必ず最新の状態に保ってください。

### タイトルフォーマット
`<type>: <subject>` (コミットメッセージと同じ基準)

### 説明文フォーマット

```markdown
## Related Issue
Closes #<Issue番号> (あれば)

## User Request
<このPRで解決しようとしているユーザーの要望要約>

## AI Reasoning
<実装全体を通した設計判断>
- 採用したアーキテクチャやライブラリの選定理由
- トレードオフの考慮（なぜAではなくBを選んだか）
- 既存コードへの影響範囲の分析
- Geminiへの相談ログ要約（あれば）

## Implementation Details
- <主な変更点1>
- <主な変更点2>

## Verification
- [ ] テスト実行結果
- [ ] 動作確認手順
```

---

## Issueの作成ルール

AIがIssueを作成する場合（タスクの分解や、新たな提案など）、以下のフォーマットを使用してください。

### タイトルフォーマット
`<type>: <subject>`

### 本文フォーマット

```markdown
## Context
<背景事情と、現状の課題>

## Goal
<達成したい状態・目的>

## Proposed Solution (AI Reasoning)
<解決策の提案>
- アプローチの概要
- 予想される懸念点

## Definition of Done
- [ ] 満たすべき要件1
- [ ] 満たすべき要件2
```
